.PHONY: help install test build run clean docker-build docker-run

help: ## 도움말 표시
	@echo "사용 가능한 명령어:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-20s\033[0m %s\n", $$1, $$2}'

install: ## 의존성 설치
	@echo "Installing dependencies..."
	pip install -r backend/requirements.txt
	cd frontend && npm install

test: ## 테스트 실행
	@echo "Running tests..."
	cd backend && python -m pytest tests/ -v
	cd frontend && npm test -- --watchAll=false

build: ## 프로덕션 빌드
	@echo "Building for production..."
	cd frontend && npm run build

run: ## 개발 서버 실행
	@echo "Starting development servers..."
	@echo "Backend: http://localhost:8000"
	@echo "Frontend: http://localhost:3000"
	docker-compose up

clean: ## 정리
	@echo "Cleaning up..."
	find . -type d -name __pycache__ -delete
	find . -type f -name "*.pyc" -delete
	rm -rf frontend/build
	rm -rf frontend/node_modules

docker-build: ## Docker 이미지 빌드
	@echo "Building Docker images..."
	docker-compose build

docker-run: ## Docker 컨테이너 실행
	@echo "Running Docker containers..."
	docker-compose up -d

docker-stop: ## Docker 컨테이너 중지
	@echo "Stopping Docker containers..."
	docker-compose down

docker-logs: ## Docker 로그 확인
	docker-compose logs -f 